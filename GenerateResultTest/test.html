<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2020 Census Insights</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.2/dist/echarts.min.js"></script>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2ecc71;
            --background-color: #f5f5f5;
            --text-color: #333;
        }

        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--background-color);
            color: var(--text-color);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background-color: var(--primary-color);
            color: white;
            padding: 20px 0;
            text-align: center;
        }

        h1 {
            margin: 0;
        }

        nav {
            background-color: #2980b9;
            padding: 10px 0;
        }

        nav ul {
            list-style-type: none;
            padding: 0;
            margin: 0;
            display: flex;
            justify-content: center;
        }

        nav ul li {
            margin: 0 10px;
        }

        nav ul li a {
            color: white;
            text-decoration: none;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 20px;
        }

        .chart-container {
            background-color: white;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            padding: 20px;
        }

        .chart-title {
            font-size: 1.2em;
            margin-bottom: 10px;
        }

        .chart-description {
            font-size: 0.9em;
            color: #666;
            margin-top: 10px;
        }

        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>2020 Census Insights</h1>
    </header>
    <nav>
        <ul>
            <li><a href="#age-distribution">Age Distribution</a></li>
            <li><a href="#education-gender">Education by Gender</a></li>
            <li><a href="#income-distribution">Income Distribution</a></li>
            <li><a href="#income-occupation">Income by Occupation</a></li>
            <li><a href="#top-earners">Top Earning Occupations</a></li>
        </ul>
    </nav>
    <div class="container">
        <div class="grid">
            <div class="chart-container">
                <h2 class="chart-title">Age Distribution</h2>
                <div id="age-distribution"></div>
                <p class="chart-description">The age distribution shows a concentration of individuals between 20-40 years old. There's a noticeable drop in population after age 65, indicating a smaller elderly demographic.</p>
            </div>
            <div class="chart-container">
                <h2 class="chart-title">Education Level by Gender</h2>
                <div id="education-gender"></div>
                <p class="chart-description">Bachelor's degrees are the most common education level for both genders. There's a slight gender gap in higher education, with more males holding advanced degrees.</p>
            </div>
            <div class="chart-container">
                <h2 class="chart-title">Income Distribution</h2>
                <div id="income-distribution"></div>
                <p class="chart-description">The income distribution shows a right-skewed pattern, with a significant number of individuals in lower income brackets. There's a notable spike in the highest income category.</p>
            </div>
            <div class="chart-container">
                <h2 class="chart-title">Income by Occupation</h2>
                <div id="income-occupation"></div>
                <p class="chart-description">Executive-managerial and professional specialty occupations have the highest average incomes. Service and farming-fishing occupations show lower average incomes.</p>
            </div>
            <div class="chart-container">
                <h2 class="chart-title">Top Earning Occupations</h2>
                <div id="top-earners"></div>
                <p class="chart-description">Executive-managerial roles lead in earnings, followed by professional specialties. Sales and construction occupations also feature among the top-earning categories.</p>
            </div>
        </div>
    </div>
    <script>
        // D3.js - Age Distribution
        const ageData = Object.entries({"age_counts":{"17":27,"18":47,"19":62,"20":89,"21":80,"22":122,"23":94,"24":100,"25":106,"26":81,"27":106,"28":102,"29":91,"30":110,"31":115,"32":101,"33":97,"34":82,"35":92,"36":77,"37":112,"38":90,"39":73,"40":85,"41":101,"42":81,"43":70,"44":75,"45":87,"46":84,"47":83,"48":79,"49":86,"50":79,"51":85,"52":75,"53":82,"54":75,"55":93,"56":109,"57":76,"58":87,"59":80,"60":92,"61":81,"62":94,"63":74,"64":65,"65":53,"66":47,"67":52,"68":32,"69":28,"70":21,"71":14,"72":18,"73":20,"74":17,"75":12,"76":6,"77":6,"78":8,"79":5,"80":16,"85":11}}.age_counts).map(([age, count]) => ({ age: +age, count }));

        const margin = { top: 20, right: 20, bottom: 30, left: 40 };
        const width = 500 - margin.left - margin.right;
        const height = 300 - margin.top - margin.bottom;

        const x = d3.scaleBand()
            .range([0, width])
            .padding(0.1);

        const y = d3.scaleLinear()
            .range([height, 0]);

        const svg = d3.select("#age-distribution").append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform", `translate(${margin.left},${margin.top})`);

        x.domain(ageData.map(d => d.age));
        y.domain([0, d3.max(ageData, d => d.count)]);

        svg.selectAll(".bar")
            .data(ageData)
            .enter().append("rect")
            .attr("class", "bar")
            .attr("x", d => x(d.age))
            .attr("width", x.bandwidth())
            .attr("y", d => y(d.count))
            .attr("height", d => height - y(d.count))
            .attr("fill", "steelblue");

        svg.append("g")
            .attr("transform", `translate(0,${height})`)
            .call(d3.axisBottom(x))
            .selectAll("text")
            .style("text-anchor", "end")
            .attr("dx", "-.8em")
            .attr("dy", ".15em")
            .attr("transform", "rotate(-65)");

        svg.append("g")
            .call(d3.axisLeft(y));

        // Plotly.js - Education Level by Gender
        const eduData = {"edu_gender":{"10th":{"Female":24,"Male":28},"11th":{"Female":33,"Male":41},"12th":{"Female":16,"Male":30},"1st-4th":{"Female":2,"Male":5},"5th-6th":{"Female":11,"Male":17},"7th-8th":{"Female":8,"Male":21},"9th":{"Female":18,"Male":30},"Assoc-acdm":{"Female":169,"Male":131},"Assoc-voc":{"Female":99,"Male":121},"Bachelors":{"Female":500,"Male":579},"Doctorate":{"Female":36,"Male":66},"HS-grad":{"Female":485,"Male":697},"Masters":{"Female":218,"Male":230},"Preschool":{"Female":1,"Male":4},"Prof-school":{"Female":20,"Male":51},"Some-college":{"Female":376,"Male":433}}};
        const eduLevels = Object.keys(eduData.edu_gender);
        const femaleData = eduLevels.map(level => eduData.edu_gender[level].Female);
        const maleData = eduLevels.map(level => eduData.edu_gender[level].Male);

        const trace1 = {
            x: eduLevels,
            y: femaleData,
            name: 'Female',
            type: 'bar'
        };

        const trace2 = {
            x: eduLevels,
            y: maleData,
            name: 'Male',
            type: 'bar'
        };

        const layout = {
            barmode: 'group',
            height: 400,
            margin: { l: 50, r: 50, b: 100, t: 50, pad: 4 }
        };

        Plotly.newPlot('education-gender', [trace1, trace2], layout);

        // Chart.js - Income Distribution
        const incomeData = {"income_dist":{"1250":53,"3750":83,"6250":101,"8750":81,"11250":147,"13750":72,"16250":147,"18750":106,"21250":191,"23750":105,"26250":186,"28750":104,"31250":234,"33750":86,"36250":162,"38750":89,"41250":201,"43750":76,"46250":129,"48750":98,"51250":180,"53750":66,"56250":117,"58750":60,"61250":147,"63750":45,"66250":87,"68750":53,"71250":77,"73750":46,"76250":78,"78750":36,"81250":65,"83750":34,"86250":62,"88750":26,"91250":56,"93750":25,"96250":35,"98750":32,"101250":722}};
        const ctx = document.createElement('canvas');
        document.getElementById('income-distribution').appendChild(ctx);

        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: Object.keys(incomeData.income_dist),
                datasets: [{
                    label: 'Count',
                    data: Object.values(incomeData.income_dist),
                    backgroundColor: 'rgba(75, 192, 192, 0.6)',
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });

        // ECharts - Income by Occupation
        const incomeByOccData = {"income_by_occ":{"?":32486.654804270464,"Adm-clerical":44720.93023255814,"Construction":47872.596153846156,"Craft-repair":53588.12949640288,"Exec-managerial":71025.09778357236,"Farming-fishing":34187.5,"Other-service":32073.699421965317,"Production":42821.78217821782,"Prof-specialty":64118.142444658326,"Sales":46361.25654450262,"Transport-moving":40515.625}};
        const incomeChart = echarts.init(document.getElementById('income-occupation'));
        const incomeOption = {
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'shadow'
                }
            },
            xAxis: {
                type: 'category',
                data: Object.keys(incomeByOccData.income_by_occ),
                axisLabel: {
                    interval: 0,
                    rotate: 45
                }
            },
            yAxis: {
                type: 'value',
                name: 'Average Income'
            },
            series: [{
                data: Object.values(incomeByOccData.income_by_occ),
                type: 'bar'
            }]
        };
        incomeChart.setOption(incomeOption);

        // Highcharts - Top Earning Occupations
        const topEarnersData = {"top_earners":{"Construction":47872.596153846156,"Craft-repair":53588.12949640288,"Exec-managerial":71025.09778357236,"Prof-specialty":64118.142444658326,"Sales":46361.25654450262}};
        Highcharts.chart('top-earners', {
            chart: {
                type: 'column'
            },
            title: {
                text: ''
            },
            xAxis: {
                categories: Object.keys(topEarnersData.top_earners),
                crosshair: true
            },
            yAxis: {
                min: 0,
                title: {
                    text: 'Average Income'
                }
            },
            tooltip: {
                headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                    '<td style="padding:0"><b>${point.y:.2f}</b></td></tr>',
                footerFormat: '</table>',
                shared: true,
                useHTML: true
            },
            plotOptions: {
                column: {
                    pointPadding: 0.2,
                    borderWidth: 0
                }
            },
            series: [{
                name: 'Average Income',
                data: Object.values(topEarnersData.top_earners)
            }]
        });
    </script>
</body>
</html>